32c32
< let chacha20_line (a b d s: uint_size) (m: state_t) : state_t =
---
> let chacha20_line (a b d: state_idx_t) (s: pos {s < 32}) (m: state_t) : state_t =
40c40
< let chacha20_quarter_round (a b c d: uint_size) (state: state_t) : state_t =
---
> let chacha20_quarter_round (a b c d: state_idx_t) (state: state_t) : state_t =
58c58
<   Dummy.foldi 0 10 (fun (_i: uint_size) (st: state_t) -> chacha20_double_round st) st
---
>   foldi 0 10 (fun (_i: uint_size) (st: state_t) -> chacha20_double_round st) st
97c97
<       (plain: Hacspec_lib_tc.seq_t Secret_integers.u8_t)
---
>       (plain: Hacspec_lib_tc.seq_t Secret_integers.u8_t {seq_len plain < 64})
106c106
<   let blocks_out:Hacspec_lib_tc.seq_t Secret_integers.u8_t =
---
>   let blocks_out =
110,111c110,111
<   let blocks_out:Hacspec_lib_tc.seq_t Secret_integers.u8_t =
<     Dummy.foldi 0
---
>   let blocks_out =
>     foldi 0
113c113
<       (fun (i: uint_size) (blocks_out: Hacspec_lib_tc.seq_t Secret_integers.u8_t) ->
---
>       (fun i blocks_out ->
141c141
<   chacha20_update state m
\ Pas de fin de ligne Ã  la fin du fichier
---
>   chacha20_update state m
